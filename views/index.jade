extends layout

block content
  div(class="gridster")
    ul
      li(class="title", data-row="1", data-col="1", data-sizex="2", data-sizey="1")
        h1
        form
          input(type="text" autocomplete="off" placeholder="e.g. AAPL")
      li(class="market-cap", data-row="1", data-col="2", data-sizex="1", data-sizey="1")
      li(class="volume", data-row="1", data-col="1", data-sizex="1", data-sizey="1")
      li(class="pe-ratio", data-row="1", data-col="1", data-sizex="1", data-sizey="1")
      li(class="price", data-row="1", data-col="1", data-sizex="2", data-sizey="1")
  script(type="text/javascript").
    var gridster;
    $(function() {
      gridster = $('.gridster > ul').gridster({
        widget_margins: [5, 5],
        widget_base_dimensions: [300, 360],
        avoid_overlapped_widgets: true
      }).data('gridster');
      symbol = "AAPL";
      setInterval(function() {
        var url = "http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20in%20%28%22" + symbol + "%22%29%0A%09%09&env=http%3A%2F%2Fdatatables.org%2Falltables.env&format=json";
        $.ajax({
         type: 'get',
         url: url
        }).done(function(data) {
         market_cap = data.query.results.quote.MarketCapitalization;
         volume = data.query.results.quote.Volume;
         pe_ratio = data.query.results.quote.PERatio;
         price = data.query.results.quote.AskRealtime;
         company_name = data.query.results.quote.Name;
         $('.market-cap').html(market_cap);
         $('.volume').html(volume);
         $('.pe-ratio').html(pe_ratio);
         $('.price').html(price);
         $('h1').html(company_name);
        });
      }, 1000)
      $('form').on('submit', function(e) {
          e.preventDefault();
          symbol = $('input').val();
        });
    });
 

